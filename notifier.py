#!/usr/bin/env python3
import asyncio
import aiohttp
from datetime import datetime
from calendar import monthcalendar
import logging
import random
import sys

logging.basicConfig(level=logging.INFO, format='%(asctime)s - %(levelname)s - %(message)s')
logger = logging.getLogger(__name__)

class PersonalScheduleNotifier:
    def __init__(self):
        self.telegram_token = "8442392037:AAEiM_b4QfdFLqbmmc1PXNvA99yxmFVLEp8"
        self.chat_id = "350766421"
        
        self.wisdoms = [
            "–ö–∞–∂–¥—ã–π –Ω–æ–≤—ã–π –¥–µ–Ω—å ‚Äî —ç—Ç–æ –Ω–æ–≤–∞—è –≤–æ–∑–º–æ–∂–Ω–æ—Å—Ç—å. –ò—Å–ø–æ–ª—å–∑—É–π –µ—ë –ø–æ –º–∞–∫—Å–∏–º—É–º—É.",
            "–¢—ã –ª–∏–±–æ —Ä–∞–± —Å–≤–æ–∏—Ö —Å—Ç—Ä–∞—Ö–æ–≤, –ª–∏–±–æ —Ä–∞–± —Å–≤–æ–µ–π –¥–∏—Å—Ü–∏–ø–ª–∏–Ω—ã. –í—ã–±–æ—Ä –∑–∞ —Ç–æ–±–æ–π.",
            "–ñ–∏–≤–∏ –Ω–∞—Å—Ç–æ—è—â–∏–º. –í—á–µ—Ä–∞ —É–∂–µ –ø—Ä–æ—à–ª–æ, –∑–∞–≤—Ç—Ä–∞ –µ—â—ë –Ω–µ –Ω–∞—Å—Ç—É–ø–∏–ª–æ. –î–µ–π—Å—Ç–≤—É–π —Å–µ–π—á–∞—Å.",
            "–£—Å–ø–µ—Ö ‚Äî —ç—Ç–æ —Ü–µ–ø–æ—á–∫–∞ –ø—Ä–∞–≤–∏–ª—å–Ω—ã—Ö –¥–µ–π—Å—Ç–≤–∏–π. –û–¥–Ω–æ –¥–µ–π—Å—Ç–≤–∏–µ –≤–µ–¥—ë—Ç –∫ –¥—Ä—É–≥–æ–º—É. –ù–µ –æ—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞–π—Å—è.",
            "–õ—É—á—à–µ —Å–¥–µ–ª–∞—Ç—å –∏ –ø–æ–∂–∞–ª–µ—Ç—å, —á–µ–º –Ω–µ —Å–¥–µ–ª–∞—Ç—å –∏ –∂–∞–ª–µ—Ç—å –≤–µ—á–Ω–æ.",
            "–ö–æ–Ω—Ç—Ä–æ–ª—å ‚Äî —ç—Ç–æ –∏–ª–ª—é–∑–∏—è. –°–Ω–∞—á–∞–ª–∞ –Ω–∞—É—á–∏—Å—å —É–ø—Ä–∞–≤–ª—è—Ç—å —Å–æ–±–æ–π. –ü–æ—Ç–æ–º –æ—Å—Ç–∞–ª—å–Ω–æ–µ –ø—Ä–∏–¥—ë—Ç.",
            "–õ—é–¥–∏ –Ω–µ –ø–æ–º–æ–≥—É—Ç —Ç–µ–±–µ. –ù–∞–¥–µ–π—Å—è —Ç–æ–ª—å–∫–æ –Ω–∞ —Å–µ–±—è. –ü–æ–º–æ—â—å –¥—Ä—É–≥–∏—Ö ‚Äî –±–æ–Ω—É—Å.",
            "–õ—É—á—à–∏–π –ø–æ–¥–∞—Ä–æ–∫ –¥–µ—Ç—è–º ‚Äî —ç—Ç–æ —Ñ–∏–Ω–∞–Ω—Å–æ–≤–∞—è –Ω–µ–∑–∞–≤–∏—Å–∏–º–æ—Å—Ç—å –∏—Ö —Ä–æ–¥–∏—Ç–µ–ª–µ–π.",
            "–ï—Å–ª–∏ –Ω—É–∂–µ–Ω –æ—Ç–ø—É—Å–∫ –æ—Ç —Ä–∞–±–æ—Ç—ã ‚Äî —ç—Ç–æ –Ω–µ —Ç–≤–æ—è —Ä–∞–±–æ—Ç–∞. –£—Ö–æ–¥–∏.",
            "–ï—Å–ª–∏ —Ç—ã —Å–∞–º—ã–π —É–º–Ω—ã–π –≤ –∫–æ–º–Ω–∞—Ç–µ ‚Äî –∏–¥–∏ –≤ –¥—Ä—É–≥—É—é –∫–æ–º–Ω–∞—Ç—É.",
            "–°–ª–æ–∂–Ω–µ–µ –≤—Å–µ–≥–æ –¥–µ–ª–∞—Ç—å –ø—Ä–æ—Å—Ç–æ –∏ —Ä–∞–∑—É–º–Ω–æ. –û—Å—Ç–∞–ª—å–Ω–æ–µ ‚Äî –ª–µ–≥–∫–æ.",
            "–ü–µ–Ω—Å–∏–∏ –Ω–µ –±—É–¥–µ—Ç. –ì–∞—Ä–∞–Ω—Ç–∏–π –≤–æ–æ–±—â–µ –Ω–µ —Å—É—â–µ—Å—Ç–≤—É–µ—Ç. –†–∞—Å—Å—á–∏—Ç—ã–≤–∞–π —Ç–æ–ª—å–∫–æ –Ω–∞ —Å–µ–±—è.",
            "–ë–æ–ª—å—à–∏–µ –∏–∑–º–µ–Ω–µ–Ω–∏—è —Ç—Ä–µ–±—É—é—Ç –≤—Ä–µ–º–µ–Ω–∏. –ú–Ω–æ–≥–æ –≤—Ä–µ–º–µ–Ω–∏. –ë—É–¥—å —Ç–µ—Ä–ø–µ–ª–∏–≤.",
            "–ó–∞ –∫–∞–∂–¥—ã–º –≤–µ–ª–∏–∫–∏–º –¥–æ—Å—Ç–∏–∂–µ–Ω–∏–µ–º —Å—Ç–æ–∏—Ç –æ—Ç—Ä–µ—á–µ–Ω–∏–µ –æ—Ç —á–µ–≥–æ-—Ç–æ –º–∞–ª–æ–≥–æ.",
            "–ë—ã—Ç—å –±–µ–¥–Ω—ã–º ‚Äî –Ω–µ–ø—Ä–∞–∫—Ç–∏—á–Ω–æ –∏ —É–Ω–∏–∑–∏—Ç–µ–ª—å–Ω–æ. –ú–µ–Ω—è–π —ç—Ç–æ.",
            "–ü—Ä–∏–æ—Ä–∏—Ç–µ—Ç—ã ‚Äî —ç—Ç–æ –ø—Ä–æ –≤—ã–±–æ—Ä —Å–∞–º–æ–≥–æ –≤–∞–∂–Ω–æ–≥–æ –∏ –æ—Ç–∫–∞–∑ –æ—Ç –æ—Å—Ç–∞–ª—å–Ω–æ–≥–æ.",
            "–£—Å–ø–µ—Ö ‚Äî —ç—Ç–æ –¥–æ–º–∏–Ω–æ—à–Ω–∞—è —Ü–µ–ø–æ—á–∫–∞. –û–¥–Ω–æ –¥–µ–π—Å—Ç–≤–∏–µ —Ç–æ–ª–∫–∞–µ—Ç –¥—Ä—É–≥–æ–µ. –ù–∞—á–Ω–∏.",
            "–õ—é–±–æ–≤—å, –≤—Ä–µ–º—è –∏ –±–ª–∞–≥–æ–¥–∞—Ä–Ω–æ—Å—Ç—å ‚Äî –≤–æ—Ç —á—Ç–æ –∏–º–µ–µ—Ç –∑–Ω–∞—á–µ–Ω–∏–µ –≤ –∫–æ–Ω—Ü–µ."
        ]
        
        self.recurring_events = {
            'tarelka': {'name': '–°–µ–º–µ–π–Ω–∞—è —Ç—Ä–∞–¥–∏—Ü–∏—è - –ü—É—Ç–µ—â–µ–≤—Å—Ç–≤–∏–µ –Ω–∞ —Ç–∞—Ä–µ–ª–∫–µ', 'file': 'tarelka.txt', 'rule': 'last_saturday'},
            'chronos': {'name': '–°–µ–º–µ–π–Ω–∞—è —Ç—Ä–∞–¥–∏—Ü–∏—è - –í–µ—á–µ—Ä –≤–æ—Å–ø–æ–º–∏–Ω–∞–Ω–∏–π. –•—Ä–∞–Ω–∏—Ç–µ–ª–∏ –≤—Ä–µ–º–µ–Ω–∏', 'file': 'chronos.txt', 'rule': 'third_saturday'},
            'new': {'name': '–°–µ–º–µ–π–Ω–∞—è —Ç—Ä–∞–¥–∏—Ü–∏—è - –î–µ–Ω—å –Ω–æ–≤–æ–≥–æ', 'file': 'new.txt', 'rule': 'second_saturday'}
        }
        
        self.schedule = {
            'monday': {
                '—É—Ç—Ä–æ': ['‚öñÔ∏è –í–∑–≤–µ—Å–∏—Ç—å—Å—è –Ω–∞ –≤–µ—Å–∞—Ö', 'üí™ –°–¥–µ–ª–∞—Ç—å –ó–∞—Ä—è–¥–∫—É', 'üíä –ü—Ä–∏–º–∏ –í–∏—Ç–∞–º–∏–Ω—ã', 'üíù –°–¥–µ–ª–∞—Ç—å –∫–æ–º–ø–ª–∏–º–µ–Ω—Ç –ú–∞—Ä—Ç–µ –∏ –°–∞—à–µ', 'üì∫ –ü–æ—Å–º–æ—Ç—Ä–µ—Ç—å –ê–º–æ –±–ª–æ–≥ –Ω–∞ youtube', 'üéì English –Ω–∞ Youtube 20 min', 'üöÄ –î–µ–≤–∏–∑ –¥–Ω—è: –ù–∏—á–µ–≥–æ –Ω–µ –±–æ–π—Å—è –∏ –Ω–µ —Å–¥–∞–≤–∞–π—Å—è!', 'üß† –ê—Ñ—Ñ–æ—Ä–º–∞—Ü–∏—è 5 –º–∏–Ω—É—Ç'],
                '–¥–µ–Ω—å': ['üìö –ß–∏—Ç–∞—Ç—å 25 –º–∏–Ω—É—Ç', 'üéØ –ü—Ä–æ–≤–µ—Ä–∏—Ç—å –¶–µ–ª–∏', 'üí™ –ü–æ–¥—Ç—è–Ω—É—Ç—å—Å—è min 10 —Ä–∞–∑', 'üí™ –£–ø—Ä–∞–∂–Ω–µ–Ω–∏–µ –Ω–∞ –ø—Ä–µ—Å—Å 2 –ø–æ–¥—Ö–æ–¥–∞ min 15 —Ä–∞–∑', 'ü§ê –ú–æ–ª—á–∞–Ω–∏–µ –∑–æ–ª–æ—Ç–æ. –ù–µ –ø–µ—Ä–µ–±–∏–≤–∞–π'],
                '–Ω–µ–ª—å–∑—è_–¥–µ–Ω—å': ['‚ùå –†—É–≥–∞—Ç—å—Å—è –º–∞—Ç–æ–º', '‚ùå –î', 'üç∑ –ü–∏—Ç—å –∞–ª–∫–æ–≥–æ–ª—å (–û–Ω –∫—Ä–∞–¥–µ—Ç —Ç–≤–æ—é —ç–Ω–µ—Ä–≥–∏—é, –¥–µ–Ω—å–≥–∏ –∏ –≤–Ω–µ—à–Ω–æ—Å—Ç—å)'],
                '–≤–µ—á–µ—Ä': ['üìñ –ß–∏—Ç–∞—Ç—å —Å –ú–∞—Ä—Ç–æ–π', 'üìî –ó–∞–ø–æ–ª–Ω–∏ –≠–º–æ—Ü–∏–æ–Ω–∞–ª—å–Ω—ã–π –¥–Ω–µ–≤–Ω–∏–∫ (–±—É–¥–µ—à—å —É–ø—Ä–∞–≤–ª—è—Ç—å —ç–º–æ—Ü–∏—è–º–∏)', 'üíª –†–∞–±–æ—Ç–∞—Ç—å 2 —á–∞—Å–∞ –Ω–∞–¥ Pet Project', 'üß† 25 –º–∏–Ω—É—Ç —Å –ø—Å–∏—Ö–æ–ª–æ–≥–æ–º', 'üá¨üáß –ú–∞—Ä—Ç–∞ English', 'üçΩÔ∏è –ú–∞—Ä—Ç–∞ –º–æ–µ—Ç –ø–æ—Å—É–¥—É', 'üíä –ü—Ä–∏–º–∏ –ú–∞–≥–Ω–∏–π –ø–µ—Ä–µ–¥ —Å–Ω–æ–º', 'üë®‚Äçüë©‚Äçüëß –í–µ—á–µ—Ä–Ω—è—è –±–ª–∞–≥–æ–¥–∞—Ä–Ω–æ—Å—Ç—å', 'üß† –ê—Ñ—Ñ–æ—Ä–º–∞—Ü–∏—è 5 –º–∏–Ω—É—Ç']
            },
            'tuesday': {
                '—É—Ç—Ä–æ': ['‚öñÔ∏è –í–∑–≤–µ—Å–∏—Ç—å—Å—è –Ω–∞ –≤–µ—Å–∞—Ö', 'üí™ –°–¥–µ–ª–∞—Ç—å –ó–∞—Ä—è–¥–∫—É', 'üíä –ü—Ä–∏–º–∏ –í–∏—Ç–∞–º–∏–Ω—ã', 'üíù –°–¥–µ–ª–∞—Ç—å –∫–æ–º–ø–ª–∏–º–µ–Ω—Ç –ú–∞—Ä—Ç–µ –∏ –°–∞—à–µ', 'üì∫ –ü–æ—Å–º–æ—Ç—Ä–µ—Ç—å –ê–º–æ –±–ª–æ–≥ –Ω–∞ youtube', 'üéì English –Ω–∞ Youtube 20 min', 'üöÄ –î–µ–≤–∏–∑ –¥–Ω—è: –ù–∏—á–µ–≥–æ –Ω–µ –±–æ–π—Å—è –∏ –Ω–µ —Å–¥–∞–≤–∞–π—Å—è!', 'üß† –ê—Ñ—Ñ–æ—Ä–º–∞—Ü–∏—è 5 –º–∏–Ω—É—Ç'],
                '–¥–µ–Ω—å': ['üìö –ß–∏—Ç–∞—Ç—å 25 –º–∏–Ω—É—Ç', 'üéØ –ü—Ä–æ–≤–µ—Ä–∏—Ç—å –¶–µ–ª–∏', 'üí™ –ü–æ–¥—Ç—è–Ω—É—Ç—å—Å—è min 10 —Ä–∞–∑', 'üí™ –£–ø—Ä–∞–∂–Ω–µ–Ω–∏–µ –Ω–∞ –ø—Ä–µ—Å—Å 2 –ø–æ–¥—Ö–æ–¥–∞ min 15 —Ä–∞–∑', 'ü§ê –ú–æ–ª—á–∞–Ω–∏–µ –∑–æ–ª–æ—Ç–æ. –ù–µ –ø–µ—Ä–µ–±–∏–≤–∞–π'],
                '–Ω–µ–ª—å–∑—è_–¥–µ–Ω—å': ['‚ùå –†—É–≥–∞—Ç—å—Å—è –º–∞—Ç–æ–º', '‚ùå –î', 'üç∑ –ü–∏—Ç—å –∞–ª–∫–æ–≥–æ–ª—å (–û–Ω –∫—Ä–∞–¥–µ—Ç —Ç–≤–æ—é —ç–Ω–µ—Ä–≥–∏—é, –¥–µ–Ω—å–≥–∏ –∏ –≤–Ω–µ—à–Ω–æ—Å—Ç—å)'],
                '–≤–µ—á–µ—Ä': ['üìñ –ß–∏—Ç–∞—Ç—å —Å –ú–∞—Ä—Ç–æ–π', 'üìî –ó–∞–ø–æ–ª–Ω–∏ –≠–º–æ—Ü–∏–æ–Ω–∞–ª—å–Ω—ã–π –¥–Ω–µ–≤–Ω–∏–∫ (–±—É–¥–µ—à—å —É–ø—Ä–∞–≤–ª—è—Ç—å —ç–º–æ—Ü–∏—è–º–∏)', 'üíª –†–∞–±–æ—Ç–∞—Ç—å 2 —á–∞—Å–∞ –Ω–∞–¥ Pet Project', 'üß† 25 –º–∏–Ω—É—Ç —Å –ø—Å–∏—Ö–æ–ª–æ–≥–æ–º', 'üá¨üáß –ú–∞—Ä—Ç–∞ English', 'üçΩÔ∏è –ê—Ä–∫–∞—à–∞ –º–æ–µ—Ç –ø–æ—Å—É–¥—É', 'üíä –ü—Ä–∏–º–∏ –ú–∞–≥–Ω–∏–π –ø–µ—Ä–µ–¥ —Å–Ω–æ–º', 'üë®‚Äçüë©‚Äçüëß –í–µ—á–µ—Ä–Ω—è—è –±–ª–∞–≥–æ–¥–∞—Ä–Ω–æ—Å—Ç—å', 'üß† –ê—Ñ—Ñ–æ—Ä–º–∞—Ü–∏—è 5 –º–∏–Ω—É—Ç']
            },
            'wednesday': {
                '—É—Ç—Ä–æ': ['‚öñÔ∏è –í–∑–≤–µ—Å–∏—Ç—å—Å—è –Ω–∞ –≤–µ—Å–∞—Ö', 'üí™ –°–¥–µ–ª–∞—Ç—å –ó–∞—Ä—è–¥–∫—É', 'üíä –ü—Ä–∏–º–∏ –í–∏—Ç–∞–º–∏–Ω—ã', 'üíù –°–¥–µ–ª–∞—Ç—å –∫–æ–º–ø–ª–∏–º–µ–Ω—Ç –ú–∞—Ä—Ç–µ –∏ –°–∞—à–µ', 'üì∫ –ü–æ—Å–º–æ—Ç—Ä–µ—Ç—å –ê–º–æ –±–ª–æ–≥ –Ω–∞ youtube', 'üéì English –Ω–∞ Youtube 20 min', 'üöÄ –î–µ–≤–∏–∑ –¥–Ω—è: –ù–∏—á–µ–≥–æ –Ω–µ –±–æ–π—Å—è –∏ –Ω–µ —Å–¥–∞–≤–∞–π—Å—è!', 'üß† –ê—Ñ—Ñ–æ—Ä–º–∞—Ü–∏—è 5 –º–∏–Ω—É—Ç'],
                '–¥–µ–Ω—å': ['üìö –ß–∏—Ç–∞—Ç—å 25 –º–∏–Ω—É—Ç', 'üéØ –ü—Ä–æ–≤–µ—Ä–∏—Ç—å –¶–µ–ª–∏', 'üí™ –ü–æ–¥—Ç—è–Ω—É—Ç—å—Å—è min 10 —Ä–∞–∑', 'üí™ –£–ø—Ä–∞–∂–Ω–µ–Ω–∏–µ –Ω–∞ –ø—Ä–µ—Å—Å 2 –ø–æ–¥—Ö–æ–¥–∞ min 15 —Ä–∞–∑', 'ü§ê –ú–æ–ª—á–∞–Ω–∏–µ –∑–æ–ª–æ—Ç–æ. –ù–µ –ø–µ—Ä–µ–±–∏–≤–∞–π'],
                '–Ω–µ–ª—å–∑—è_–¥–µ–Ω—å': ['‚ùå –†—É–≥–∞—Ç—å—Å—è –º–∞—Ç–æ–º', '‚ùå –î', 'üç∑ –ü–∏—Ç—å –∞–ª–∫–æ–≥–æ–ª—å (–û–Ω –∫—Ä–∞–¥–µ—Ç —Ç–≤–æ—é —ç–Ω–µ—Ä–≥–∏—é, –¥–µ–Ω—å–≥–∏ –∏ –≤–Ω–µ—à–Ω–æ—Å—Ç—å)'],
                '–≤–µ—á–µ—Ä': ['üìñ –ß–∏—Ç–∞—Ç—å —Å –ú–∞—Ä—Ç–æ–π', 'üìî –ó–∞–ø–æ–ª–Ω–∏ –≠–º–æ—Ü–∏–æ–Ω–∞–ª—å–Ω—ã–π –¥–Ω–µ–≤–Ω–∏–∫ (–±—É–¥–µ—à—å —É–ø—Ä–∞–≤–ª—è—Ç—å —ç–º–æ—Ü–∏—è–º–∏)', 'üíª –†–∞–±–æ—Ç–∞—Ç—å 2 —á–∞—Å–∞ –Ω–∞–¥ Pet Project', 'üß† 25 –º–∏–Ω—É—Ç —Å –ø—Å–∏—Ö–æ–ª–æ–≥–æ–º', 'üá¨üáß –ú–∞—Ä—Ç–∞ English', 'üçΩÔ∏è –ú–∞—Ä—Ç–∞ –º–æ–µ—Ç –ø–æ—Å—É–¥—É', 'üíä –ü—Ä–∏–º–∏ –ú–∞–≥–Ω–∏–π –ø–µ—Ä–µ–¥ —Å–Ω–æ–º', 'üë®‚Äçüë©‚Äçüëß –í–µ—á–µ—Ä–Ω—è—è –±–ª–∞–≥–æ–¥–∞—Ä–Ω–æ—Å—Ç—å', 'üß† –ê—Ñ—Ñ–æ—Ä–º–∞—Ü–∏—è 5 –º–∏–Ω—É—Ç']
            },
            'thursday': {
                '—É—Ç—Ä–æ': ['‚öñÔ∏è –í–∑–≤–µ—Å–∏—Ç—å—Å—è –Ω–∞ –≤–µ—Å–∞—Ö', 'üí™ –°–¥–µ–ª–∞—Ç—å –ó–∞—Ä—è–¥–∫—É', 'üíä –ü—Ä–∏–º–∏ –í–∏—Ç–∞–º–∏–Ω—ã', 'üíù –°–¥–µ–ª–∞—Ç—å –∫–æ–º–ø–ª–∏–º–µ–Ω—Ç –ú–∞—Ä—Ç–µ –∏ –°–∞—à–µ', 'üì∫ –ü–æ—Å–º–æ—Ç—Ä–µ—Ç—å –ê–º–æ –±–ª–æ–≥ –Ω–∞ youtube', 'üéì English –Ω–∞ Youtube 20 min', 'üöÄ –î–µ–≤–∏–∑ –¥–Ω—è: –ù–∏—á–µ–≥–æ –Ω–µ –±–æ–π—Å—è –∏ –Ω–µ —Å–¥–∞–≤–∞–π—Å—è!', 'üß† –ê—Ñ—Ñ–æ—Ä–º–∞—Ü–∏—è 5 –º–∏–Ω—É—Ç'],
                '–¥–µ–Ω—å': ['üìö –ß–∏—Ç–∞—Ç—å 25 –º–∏–Ω—É—Ç', 'üéØ –ü—Ä–æ–≤–µ—Ä–∏—Ç—å –¶–µ–ª–∏', 'üí™ –ü–æ–¥—Ç—è–Ω—É—Ç—å—Å—è min 10 —Ä–∞–∑', 'üí™ –£–ø—Ä–∞–∂–Ω–µ–Ω–∏–µ –Ω–∞ –ø—Ä–µ—Å—Å 2 –ø–æ–¥—Ö–æ–¥–∞ min 15 —Ä–∞–∑', 'ü§ê –ú–æ–ª—á–∞–Ω–∏–µ –∑–æ–ª–æ—Ç–æ. –ù–µ –ø–µ—Ä–µ–±–∏–≤–∞–π'],
                '–Ω–µ–ª—å–∑—è_–¥–µ–Ω—å': ['‚ùå –†—É–≥–∞—Ç—å—Å—è –º–∞—Ç–æ–º', '‚ùå –î', 'üç∑ –ü–∏—Ç—å –∞–ª–∫–æ–≥–æ–ª—å (–û–Ω –∫—Ä–∞–¥–µ—Ç —Ç–≤–æ—é —ç–Ω–µ—Ä–≥–∏—é, –¥–µ–Ω—å–≥–∏ –∏ –≤–Ω–µ—à–Ω–æ—Å—Ç—å)'],
                '–≤–µ—á–µ—Ä': ['üìñ –ß–∏—Ç–∞—Ç—å —Å –ú–∞—Ä—Ç–æ–π', 'üìî –ó–∞–ø–æ–ª–Ω–∏ –≠–º–æ—Ü–∏–æ–Ω–∞–ª—å–Ω—ã–π –¥–Ω–µ–≤–Ω–∏–∫ (–±—É–¥–µ—à—å —É–ø—Ä–∞–≤–ª—è—Ç—å —ç–º–æ—Ü–∏—è–º–∏)', 'üíª –†–∞–±–æ—Ç–∞—Ç—å 2 —á–∞—Å–∞ –Ω–∞–¥ Pet Project', 'üß† 25 –º–∏–Ω—É—Ç —Å –ø—Å–∏—Ö–æ–ª–æ–≥–æ–º', 'üá¨üáß –ú–∞—Ä—Ç–∞ English', 'üçΩÔ∏è –ê—Ä–∫–∞—à–∞ –º–æ–µ—Ç –ø–æ—Å—É–¥—É', 'üíä –ü—Ä–∏–º–∏ –ú–∞–≥–Ω–∏–π –ø–µ—Ä–µ–¥ —Å–Ω–æ–º', 'üë®‚Äçüë©‚Äçüëß –í–µ—á–µ—Ä–Ω—è—è –±–ª–∞–≥–æ–¥–∞—Ä–Ω–æ—Å—Ç—å', 'üß† –ê—Ñ—Ñ–æ—Ä–º–∞—Ü–∏—è 5 –º–∏–Ω—É—Ç']
            },
            'friday': {
                '—É—Ç—Ä–æ': ['‚öñÔ∏è –í–∑–≤–µ—Å–∏—Ç—å—Å—è –Ω–∞ –≤–µ—Å–∞—Ö', 'üí™ –°–¥–µ–ª–∞—Ç—å –ó–∞—Ä—è–¥–∫—É', 'üíä –ü—Ä–∏–º–∏ –í–∏—Ç–∞–º–∏–Ω—ã', 'üíù –°–¥–µ–ª–∞—Ç—å –∫–æ–º–ø–ª–∏–º–µ–Ω—Ç –ú–∞—Ä—Ç–µ –∏ –°–∞—à–µ', 'üì∫ –ü–æ—Å–º–æ—Ç—Ä–µ—Ç—å –ê–º–æ –±–ª–æ–≥ –Ω–∞ youtube', 'üéì English –Ω–∞ Youtube 20 min', 'üöÄ –î–µ–≤–∏–∑ –¥–Ω—è: –ù–∏—á–µ–≥–æ –Ω–µ –±–æ–π—Å—è –∏ –Ω–µ —Å–¥–∞–≤–∞–π—Å—è!', 'üß† –ê—Ñ—Ñ–æ—Ä–º–∞—Ü–∏—è 5 –º–∏–Ω—É—Ç'],
                '–¥–µ–Ω—å': ['üìö –ß–∏—Ç–∞—Ç—å 25 –º–∏–Ω—É—Ç', '‚öîÔ∏è HH —É –°–∞–º—É—Ä–∞—è –Ω–µ—Ç –æ—Ñ—Ñ–µ—Ä–∞ —Ç–æ–ª—å–∫–æ –æ—Ç–∫–ª–∏–∫–∏', 'üìû –ü–æ–∑–≤–æ–Ω–∏—Ç—å —Ç–µ—Ç–µ –õ–∞—Ä–∏—Å–µ', 'üí™ –ü–æ–¥—Ç—è–Ω—É—Ç—å—Å—è min 10 —Ä–∞–∑', 'üí™ –£–ø—Ä–∞–∂–Ω–µ–Ω–∏–µ –Ω–∞ –ø—Ä–µ—Å—Å 2 –ø–æ–¥—Ö–æ–¥–∞ min 15 —Ä–∞–∑', 'ü§ê –ú–æ–ª—á–∞–Ω–∏–µ –∑–æ–ª–æ—Ç–æ. –ù–µ –ø–µ—Ä–µ–±–∏–≤–∞–π'],
                '–Ω–µ–ª—å–∑—è_–¥–µ–Ω—å': ['‚ùå –†—É–≥–∞—Ç—å—Å—è –º–∞—Ç–æ–º', '‚ùå –î', 'üç∑ –ü–∏—Ç—å –∞–ª–∫–æ–≥–æ–ª—å (–û–Ω –∫—Ä–∞–¥–µ—Ç —Ç–≤–æ—é —ç–Ω–µ—Ä–≥–∏—é, –¥–µ–Ω—å–≥–∏ –∏ –≤–Ω–µ—à–Ω–æ—Å—Ç—å)'],
                '–≤–µ—á–µ—Ä': ['üìñ –ß–∏—Ç–∞—Ç—å —Å –ú–∞—Ä—Ç–æ–π', 'üìî –ó–∞–ø–æ–ª–Ω–∏ –≠–º–æ—Ü–∏–æ–Ω–∞–ª—å–Ω—ã–π –¥–Ω–µ–≤–Ω–∏–∫ (–±—É–¥–µ—à—å —É–ø—Ä–∞–≤–ª—è—Ç—å —ç–º–æ—Ü–∏—è–º–∏)', 'üíª –†–∞–±–æ—Ç–∞—Ç—å 2 —á–∞—Å–∞ –Ω–∞–¥ Pet Project', 'üß† 25 –º–∏–Ω—É—Ç —Å –ø—Å–∏—Ö–æ–ª–æ–≥–æ–º', 'üá¨üáß –ú–∞—Ä—Ç–∞ English', 'üçΩÔ∏è –ú–∞—Ä—Ç–∞ –º–æ–µ—Ç –ø–æ—Å—É–¥—É', 'üíä –ü—Ä–∏–º–∏ –ú–∞–≥–Ω–∏–π –ø–µ—Ä–µ–¥ —Å–Ω–æ–º', 'üë®‚Äçüë©‚Äçüëß –í–µ—á–µ—Ä–Ω—è—è –±–ª–∞–≥–æ–¥–∞—Ä–Ω–æ—Å—Ç—å', 'üß† –ê—Ñ—Ñ–æ—Ä–º–∞—Ü–∏—è 5 –º–∏–Ω—É—Ç']
            },
            'saturday': {
                '—É—Ç—Ä–æ': ['‚öñÔ∏è –í–∑–≤–µ—Å–∏—Ç—å—Å—è –Ω–∞ –≤–µ—Å–∞—Ö', 'üí™ –°–¥–µ–ª–∞—Ç—å –ó–∞—Ä—è–¥–∫—É', 'üíä –ü—Ä–∏–º–∏ –í–∏—Ç–∞–º–∏–Ω—ã', 'üíù –°–¥–µ–ª–∞—Ç—å –∫–æ–º–ø–ª–∏–º–µ–Ω—Ç –ú–∞—Ä—Ç–µ –∏ –°–∞—à–µ', 'üì∫ –ü–æ—Å–º–æ—Ç—Ä–µ—Ç—å –ê–º–æ –±–ª–æ–≥ –Ω–∞ youtube', 'üöÄ –î–µ–≤–∏–∑ –¥–Ω—è: –ù–∏—á–µ–≥–æ –Ω–µ –±–æ–π—Å—è –∏ –Ω–µ —Å–¥–∞–≤–∞–π—Å—è!'],
                '–¥–µ–Ω—å': ['üìö –ß–∏—Ç–∞—Ç—å 25 –º–∏–Ω—É—Ç', 'üå∏ –ü–æ–ª–∏—Ç—å –¶–≤–µ—Ç—ã', 'üéØ –ü—Ä–æ–≤–µ—Ä–∏—Ç—å –¶–µ–ª–∏', 'üìä LP %', 'üí™ –ü–æ–¥—Ç—è–Ω—É—Ç—å—Å—è min 10 —Ä–∞–∑', 'üí™ –£–ø—Ä–∞–∂–Ω–µ–Ω–∏–µ –Ω–∞ –ø—Ä–µ—Å—Å 2 –ø–æ–¥—Ö–æ–¥–∞ min 15 —Ä–∞–∑', 'ü§ê –ú–æ–ª—á–∞–Ω–∏–µ –∑–æ–ª–æ—Ç–æ. –ù–µ –ø–µ—Ä–µ–±–∏–≤–∞–π'],
                '–Ω–µ–ª—å–∑—è_–¥–µ–Ω—å': ['‚ùå –†—É–≥–∞—Ç—å—Å—è –º–∞—Ç–æ–º', '‚ùå –î', 'üç∑ –ü–∏—Ç—å –∞–ª–∫–æ–≥–æ–ª—å (–û–Ω –∫—Ä–∞–¥–µ—Ç —Ç–≤–æ—é —ç–Ω–µ—Ä–≥–∏—é, –¥–µ–Ω—å–≥–∏ –∏ –≤–Ω–µ—à–Ω–æ—Å—Ç—å)'],
                '–≤–µ—á–µ—Ä': ['üìñ –ß–∏—Ç–∞—Ç—å —Å –ú–∞—Ä—Ç–æ–π', 'üìî –ó–∞–ø–æ–ª–Ω–∏ –≠–º–æ—Ü–∏–æ–Ω–∞–ª—å–Ω—ã–π –¥–Ω–µ–≤–Ω–∏–∫ (–±—É–¥–µ—à—å —É–ø—Ä–∞–≤–ª—è—Ç—å —ç–º–æ—Ü–∏—è–º–∏)', 'üíª –†–∞–±–æ—Ç–∞—Ç—å 2 —á–∞—Å–∞ –Ω–∞–¥ Pet Project', 'üß† 25 –º–∏–Ω—É—Ç —Å –ø—Å–∏—Ö–æ–ª–æ–≥–æ–º', 'üá¨üáß –ú–∞—Ä—Ç–∞ English', 'üçΩÔ∏è –ê—Ä–∫–∞—à–∞ –º–æ–µ—Ç –ø–æ—Å—É–¥—É', 'üíä –ü—Ä–∏–º–∏ –ú–∞–≥–Ω–∏–π –ø–µ—Ä–µ–¥ —Å–Ω–æ–º', 'üë®‚Äçüë©‚Äçüëß –í–µ—á–µ—Ä–Ω—è—è –±–ª–∞–≥–æ–¥–∞—Ä–Ω–æ—Å—Ç—å', 'üé¨ –°–µ–º–µ–π–Ω—ã–π –ø—Ä–æ—Å–º–æ—Ç—Ä —Ñ–∏–ª—å–º–∞']
            },
            'sunday': {
                '—É—Ç—Ä–æ': ['üíù –°–¥–µ–ª–∞—Ç—å –∫–æ–º–ø–ª–∏–º–µ–Ω—Ç –ú–∞—Ä—Ç–µ –∏ –°–∞—à–µ', 'üìµ –î–µ–Ω—å –±–µ–∑ –≥–∞–¥–∂–µ—Ç–æ–≤ (–ñ–∏–≤–æ–µ –æ–±—â–µ–Ω–∏–µ)', 'üë®‚Äçüë©‚Äçüëß –°–µ–º–µ–π–Ω—ã–µ —Ç—Ä–∞–¥–∏—Ü–∏–∏'],
                '–¥–µ–Ω—å': ['üë®‚Äçüë©‚Äçüëß‚Äçüë¶ Family Day (–§—É–Ω–¥–∞–º–µ–Ω—Ç –¥–æ–≤–µ—Ä–∏—è)', 'ü§ê –ú–æ–ª—á–∞–Ω–∏–µ –∑–æ–ª–æ—Ç–æ. –ù–µ –ø–µ—Ä–µ–±–∏–≤–∞–π', '‚úÖ –î (–°–µ–≥–æ–¥–Ω—è –º–æ-–æ-–æ-–∂–Ω–æ)', 'üö∂ –°–µ–º–µ–π–Ω–∞—è –ø—Ä–æ–≥—É–ª–∫–∞', 'üç≥ –°–µ–º–µ–π–Ω—ã–π –∑–∞–≤—Ç—Ä–∞–∫'],
                '–Ω–µ–ª—å–∑—è_–¥–µ–Ω—å': ['‚ùå –†—É–≥–∞—Ç—å—Å—è –º–∞—Ç–æ–º', 'üç∑ –ü–∏—Ç—å –∞–ª–∫–æ–≥–æ–ª—å (–û–Ω –∫—Ä–∞–¥–µ—Ç —Ç–≤–æ—é —ç–Ω–µ—Ä–≥–∏—é, –¥–µ–Ω—å–≥–∏ –∏ –≤–Ω–µ—à–Ω–æ—Å—Ç—å)'],
                '–≤–µ—á–µ—Ä': ['üçΩÔ∏è –†–æ–¥–∏—Ç–µ–ª–∏ –º–æ—é—Ç –ø–æ—Å—É–¥—É', 'üíä –ü—Ä–∏–º–∏ –ú–∞–≥–Ω–∏–π –ø–µ—Ä–µ–¥ —Å–Ω–æ–º', 'üë®‚Äçüë©‚Äçüëß –í–µ—á–µ—Ä–Ω—è—è –±–ª–∞–≥–æ–¥–∞—Ä–Ω–æ—Å—Ç—å']
            }
        }

    def get_random_wisdom(self):
        return random.choice(self.wisdoms)

    def get_last_day_of_month(self, year, month, day_of_week):
        cal = monthcalendar(year, month)
        for week in reversed(cal):
            if week[day_of_week] != 0:
                return week[day_of_week]
        return None

    def get_nth_day_of_month(self, year, month, day_of_week, n):
        cal = monthcalendar(year, month)
        count = 0
        for week in cal:
            if week[day_of_week] != 0:
                count += 1
                if count == n:
                    return week[day_of_week]
        return None

    def get_event_date_by_rule(self, rule, year, month):
        if rule == 'last_saturday':
            day = self.get_last_day_of_month(year, month, 5)
            return (year, month, day)
        elif rule == 'second_saturday':
            day = self.get_nth_day_of_month(year, month, 5, 2)
            return (year, month, day)
        elif rule == 'third_saturday':
            day = self.get_nth_day_of_month(year, month, 5, 3)
            return (year, month, day)
        return None

    def get_today_schedule(self):
        try:
            today = datetime.now()
            date_str = today.strftime("%d.%m.%Y")
            day_of_week = today.strftime("%A").lower()
            logger.info(f"üìÖ –°–µ–≥–æ–¥–Ω—è: {date_str}, {day_of_week}")
            today_schedule = self.schedule.get(day_of_week, {})
            return date_str, day_of_week, today_schedule
        except Exception as e:
            logger.error(f"‚ùå –û—à–∏–±–∫–∞: {e}")
            return "01.01.2024", "monday", {}

    def format_morning_day_message(self, date_str, day_of_week, schedule):
        day_names = {'monday': '–ü–æ–Ω–µ–¥–µ–ª—å–Ω–∏–∫', 'tuesday': '–í—Ç–æ—Ä–Ω–∏–∫', 'wednesday': '–°—Ä–µ–¥–∞', 'thursday': '–ß–µ—Ç–≤–µ—Ä–≥', 'friday': '–ü—è—Ç–Ω–∏—Ü–∞', 'saturday': '–°—É–±–±–æ—Ç–∞', 'sunday': '–í–æ—Å–∫—Ä–µ—Å–µ–Ω—å–µ'}
        day_ru = day_names.get(day_of_week, day_of_week)
        wisdom = self.get_random_wisdom()
        content = f"üåÖ <b>–ü–ª–∞–Ω –Ω–∞ {date_str}</b>\nüóìÔ∏è <b>{day_ru}</b>\n\n"
        if schedule.get('—É—Ç—Ä–æ'):
            content += "<b>‚òÄÔ∏è –£—Ç—Ä–µ–Ω–Ω–∏–µ –∑–∞–¥–∞—á–∏:</b>\n"
            for task in schedule['—É—Ç—Ä–æ']:
                content += f"‚Ä¢ {task}\n"
        if schedule.get('–¥–µ–Ω—å'):
            content += "\n<b>üå§Ô∏è –î–Ω–µ–≤–Ω—ã–µ –∑–∞–¥–∞—á–∏:</b>\n"
            for task in schedule['–¥–µ–Ω—å']:
                content += f"‚Ä¢ {task}\n"
        if schedule.get('–Ω–µ–ª—å–∑—è_–¥–µ–Ω—å'):
            content += "\n<b>‚õî –ù–µ–ª—å–∑—è –¥–µ–ª–∞—Ç—å:</b>\n"
            for task in schedule['–Ω–µ–ª—å–∑—è_–¥–µ–Ω—å']:
                content += f"‚Ä¢ {task}\n"
        morning_count = len(schedule.get('—É—Ç—Ä–æ', [])) - 1
        day_count = len(schedule.get('–¥–µ–Ω—å', [])) + len(schedule.get('–Ω–µ–ª—å–∑—è_–¥–µ–Ω—å', [])) - 1
        total_target = max(0, morning_count + day_count)
        content += f"\nüéØ <b>–¢–≤–æ—è –º–∏—Å—Å–∏—è –Ω–∞–±—Ä–∞—Ç—å {total_target} –±–∞–ª–ª–æ–≤!</b>\nüí™ <b>–¢—ã –º–æ–∂–µ—à—å –≤—Å—ë! –î–∞–≤–∞–π!</b>\nüí° <i>–ú—É–¥—Ä–æ—Å—Ç—å –¥–Ω—è:</i>\n<b>{wisdom}</b>"
        return content

    def format_evening_message(self, date_str, day_of_week, schedule):
        day_names = {'monday': '–ü–æ–Ω–µ–¥–µ–ª—å–Ω–∏–∫', 'tuesday': '–í—Ç–æ—Ä–Ω–∏–∫', 'wednesday': '–°—Ä–µ–¥–∞', 'thursday': '–ß–µ—Ç–≤–µ—Ä–≥', 'friday': '–ü—è—Ç–Ω–∏—Ü–∞', 'saturday': '–°—É–±–±–æ—Ç–∞', 'sunday': '–í–æ—Å–∫—Ä–µ—Å–µ–Ω—å–µ'}
        day_ru = day_names.get(day_of_week, day_of_week)
        wisdom = self.get_random_wisdom()
        task_count = len(schedule.get('–≤–µ—á–µ—Ä', []))
        target_score = max(0, task_count - 1)
        content = f"üåô <b>–í–µ—á–µ—Ä–Ω–∏–π –ø–ª–∞–Ω –Ω–∞ {date_str}</b>\nüóìÔ∏è <b>{day_ru}</b>\n\n"
        if schedule.get('–≤–µ—á–µ—Ä'):
            content += "<b>–í–µ—á–µ—Ä–Ω–∏–µ –∑–∞–¥–∞—á–∏:</b>\n"
            for task in schedule['–≤–µ—á–µ—Ä']:
                content += f"‚Ä¢ {task}\n"
        content += f"\nüéØ <b>–¢–≤–æ—è –º–∏—Å—Å–∏—è –Ω–∞–±—Ä–∞—Ç—å –≤–µ—á–µ—Ä–æ–º {target_score} –±–∞–ª–ª–æ–≤!</b>\nüåú <b>–û—Ç–ª–∏—á–Ω—ã–π –¥–µ–Ω—å! –ó–∞–≤–µ—Ä—à–∞–π –¥–µ–ª–∞ –∏ –æ—Ç–¥—ã—Ö–∞–π!</b>\nüí° <i>–ú—É–¥—Ä–æ—Å—Ç—å –¥–Ω—è:</i>\n<b>{wisdom}</b>"
        return content

    async def fetch_family_council_content(self):
        try:
            url = "https://raw.githubusercontent.com/BRKME/Day/main/SS.txt"
            async with aiohttp.ClientSession() as session:
                async with session.get(url, timeout=10) as response:
                    if response.status == 200:
                        content = await response.text()
                        logger.info("‚úÖ –§–∞–π–ª SS.txt –∑–∞–≥—Ä—É–∂–µ–Ω")
                        return content
                    else:
                        logger.error(f"‚ùå –û—à–∏–±–∫–∞ –∑–∞–≥—Ä—É–∑–∫–∏ SS.txt")
                        return None
        except Exception as e:
            logger.error(f"‚ùå –û—à–∏–±–∫–∞: {e}")
            return None

    async def fetch_event_file(self, filename):
        try:
            url = f"https://raw.githubusercontent.com/BRKME/Day/main/{filename}"
            async with aiohttp.ClientSession() as session:
                async with session.get(url, timeout=10) as response:
                    if response.status == 200:
                        content = await response.text()
                        logger.info(f"‚úÖ –§–∞–π–ª {filename} –∑–∞–≥—Ä—É–∂–µ–Ω")
                        return content
                    else:
                        logger.error(f"‚ùå –û—à–∏–±–∫–∞ –∑–∞–≥—Ä—É–∑–∫–∏ {filename}")
                        return None
        except Exception as e:
            logger.error(f"‚ùå –û—à–∏–±–∫–∞: {e}")
            return None

    def check_recurring_events(self):
        from datetime import date as dt
        today = datetime.now()
        year, month, day = today.year, today.month, today.day
        reminders = []
        for event_key, event in self.recurring_events.items():
            event_date = self.get_event_date_by_rule(event['rule'], year, month)
            if not event_date:
                continue
            event_year, event_month, event_day = event_date
            event_dt = dt(event_year, event_month, event_day)
            today_dt = dt(year, month, day)
            days_until = (event_dt - today_dt).days
            if days_until == 7:
                reminders.append({'key': event_key, 'event': event, 'type': 'week_before'})
            elif days_until == 3:
                reminders.append({'key': event_key, 'event': event, 'type': 'three_days_before'})
            elif days_until == 0:
                reminders.append({'key': event_key, 'event': event, 'type': 'event_day'})
        return reminders

    async def send_telegram_message(self, message, ss_content=None):
        try:
            url = f"https://api.telegram.org/bot{self.telegram_token}/sendMessage"
            payload = {'chat_id': self.chat_id, 'text': message, 'parse_mode': 'HTML'}
            logger.info("üì§ –û—Ç–ø—Ä–∞–≤–∫–∞ —Å–æ–æ–±—â–µ–Ω–∏—è –≤ Telegram...")
            async with aiohttp.ClientSession() as session:
                async with session.post(url, json=payload, timeout=10) as response:
                    if response.status != 200:
                        logger.error(f"‚ùå –û—à–∏–±–∫–∞ API")
                        return False
            if ss_content:
                family_msg = f"<b>üìã –°–µ–º–µ–π–Ω—ã–π —Å–æ–≤–µ—Ç:</b>\n\n{ss_content}"
                payload_council = {'chat_id': self.chat_id, 'text': family_msg, 'parse_mode': 'HTML'}
                async with aiohttp.ClientSession() as session:
                    async with session.post(url, json=payload_council, timeout=10) as response:
                        if response.status == 200:
                            logger.info("‚úÖ –°–æ–æ–±—â–µ–Ω–∏—è –æ—Ç–ø—Ä–∞–≤–ª–µ–Ω—ã!")
                            return True
                        else:
                            logger.error(f"‚ùå –û—à–∏–±–∫–∞ –æ—Ç–ø—Ä–∞–≤–∫–∏")
                            return False
            else:
                logger.info("‚úÖ –°–æ–æ–±—â–µ–Ω–∏–µ –æ—Ç–ø—Ä–∞–≤–ª–µ–Ω–æ!")
                return True
        except Exception as e:
            logger.error(f"‚ùå –û—à–∏–±–∫–∞: {e}")
            return False

    async def send_message_for_period(self, period):
        date_str, day_of_week, schedule = self.get_today_schedule()
        ss_content = None
        if period == 'morning':
            message = self.format_morning_day_message(date_str, day_of_week, schedule)
            if day_of_week == 'sunday':
                ss_content = await self.fetch_family_council_content()
            reminders = self.check_recurring_events()
            if reminders:
                for reminder in reminders:
                    event = reminder['event']
                    event_content = await self.fetch_event_file(event['file'])
                    if reminder['type'] == 'week_before':
                        message += f"\n\nüîî <b>–ù–ê–ü–û–ú–ò–ù–ê–ù–ò–ï (–ó–∞ 7 –¥–Ω–µ–π):</b>\n<b>{event['name']}</b>\n"
                        if event_content:
                            message += f"{event_content}"
                    elif reminder['type'] == 'three_days_before':
                        message += f"\n\nüîî <b>–ù–ê–ü–û–ú–ò–ù–ê–ù–ò–ï (–ó–∞ 3 –¥–Ω—è):</b>\n<b>{event['name']}</b>\n"
                        if event_content:
                            message += f"{event_content}"
                    elif reminder['type'] == 'event_day':
                        message += f"\n\nüéâ <b>–°–ï–ì–û–î–ù–Ø:</b>\n<b>{event['name']}</b>\n"
                        if event_content:
                            message += f"{event_content}"
        elif period == 'day':
            message = self.format_morning_day_message(date_str, day_of_week, schedule)
        elif period == 'evening':
            message = self.format_evening_message(date_str, day_of_week, schedule)
        else:
            logger.error(f"‚ùå –ù–µ–∏–∑–≤–µ—Å—Ç–Ω—ã–π –ø–µ—Ä–∏–æ–¥: {period}")
            return False
        return await self.send_telegram_message(message, ss_content)

async def main(period):
    logger.info(f"üöÄ –ó–∞–ø—É—Å–∫ –¥–ª—è –ø–µ—Ä–∏–æ–¥–∞: {period}")
    notifier = PersonalScheduleNotifier()
    success = await notifier.send_message_for_period(period)
    if success:
        logger.info("üéâ –£—Å–ø–µ—à–Ω–æ –∑–∞–≤–µ—Ä—à–µ–Ω–æ!")
    else:
        logger.error("üí• –û—à–∏–±–∫–∞ –ø—Ä–∏ –æ—Ç–ø—Ä–∞–≤–∫–µ")
        sys.exit(1)

if __name__ == "__main__":
    if len(sys.argv) != 2 or sys.argv[1] not in ('morning', 'day', 'evening'):
        print("‚ùå –ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ: python notifier.py <morning|day|evening>")
        sys.exit(1)
    asyncio.run(main(sys.argv[1]))
